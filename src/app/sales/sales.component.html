    <div class="sales-wrapper">

        <h1>Gesti√≥n de Ventas</h1>

        <!-- ALERTAS -->
        <div *ngIf="error" class="alert alert-error">{{ error }}</div>
        <div *ngIf="success" class="alert alert-success">{{ success }}</div>

        <div *ngIf="loading">Cargando informaci√≥n, por favor espere...</div>

        <div *ngIf="!loading">

            <!-- SELECCI√ìN DE CLIENTE -->
            <div class="filters-row">
                <div class="field">
                    <label>Cliente</label>
                    <select [(ngModel)]="selectedCustomerId" (change)="onCustomerChange()" name="customerSelect">
                        <option value="">-- Seleccione un cliente --</option>
                        <option *ngFor="let c of customers" [value]="c.id">
                            {{ getCustomerLabel(c) }}
                        </option>
                    </select>
                </div>

                <div class="summary-box" *ngIf="selectedCustomerId">
                    <div>Total √≠tems: <strong>{{ cartCount }}</strong></div>
                    <button class="btn-secondary" (click)="clearCart()" [disabled]="!cartItems.length">
                        Vaciar carrito
                    </button>
                </div>
            </div>

            <!-- FORMULARIO AGREGAR AL CARRITO -->
            <div class="card" *ngIf="selectedCustomerId">
                <h2>Agregar producto al carrito</h2>
                <div class="add-row">
                    <div class="field">
                        <label>Producto</label>
                        <select [(ngModel)]="selectedProductId" name="productSelect">
                            <option [ngValue]="null">-- Seleccione producto --</option>
                            <option *ngFor="let p of products" [ngValue]="p.id">
                                {{ p.name }} - ${{ p.unitPrice | number:'1.2-2' }}
                            </option>
                        </select>
                    </div>

                    <div class="field small">
                        <label>Cantidad</label>
                        <input type="number" [(ngModel)]="newQuantity" name="quantity" min="1" />
                    </div>

                    <div class="field">
                        <button class="btn-primary" (click)="addToCart()">Agregar</button>
                    </div>
                </div>
            </div>

            <!-- TABLA DEL CARRITO -->
            <div class="card" *ngIf="selectedCustomerId">
                <h2>Detalles del carrito</h2>

                <table class="cart-table" *ngIf="cartItems && cartItems.length">
                    <thead>
                        <tr>
                            <th>Producto</th>
                            <th>Precio unitario</th>
                            <th>Cantidad</th>
                            <th>Subtotal</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of cartItems">
                            <td>{{ item.productName }}</td>
                            <td>${{ item.unitPrice | number:'1.2-2' }}</td>
                            <td>
                                <input type="number" [(ngModel)]="item.quantity" name="qty_{{item.productId}}" min="1"
                                    (ngModelChange)="onQuantityChanged(item)" />
                            </td>

                            <td>${{ (item.unitPrice * item.quantity) | number:'1.2-2' }}</td>
                            <td class="actions-cell">
                                <button class="icon-btn delete" (click)="deleteItem(item)">üóëÔ∏è</button>
                            </td>

                        </tr>
                    </tbody>
                </table>

                <div class="totals-container" *ngIf="cartItems.length">
                    <div class="totals-box">
                        <div><strong>Subtotal:</strong> ${{ cartSubtotal | number:'1.2-2' }}</div>
                        <div><strong>IVA (15%):</strong> ${{ cartIVA | number:'1.2-2' }}</div>
                        <div><strong>Total a pagar:</strong> ${{ cartTotalPagar | number:'1.2-2' }}</div>
                    </div>
                </div>


            </div>

            <!-- FORMULARIO CREAR ORDEN -->
            <div class="card" *ngIf="selectedCustomerId && cartItems.length">
                <h2>Crear orden</h2>

                <form (ngSubmit)="createOrder()" class="order-form">
                    <div class="row">
                        <div class="field">
                            <label>Direcci√≥n de env√≠o</label>
                            <input type="text" [(ngModel)]="shipAddress" name="shipAddress" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="field">
                            <label>Ciudad</label>
                            <input type="text" [(ngModel)]="shipCity" name="shipCity" />
                        </div>
                        <div class="field">
                            <label>Pa√≠s</label>
                            <input type="text" [(ngModel)]="shipCountry" name="shipCountry" />
                        </div>
                        <div class="field small">
                            <label>C√≥digo Postal</label>
                            <input type="text" [(ngModel)]="shipPostalCode" name="shipPostalCode" />
                        </div>
                    </div>

                    <div class="buttons-row">
                        <button class="btn-primary" type="submit">Confirmar orden</button>
                    </div>
                </form>
            </div>

        </div>
    </div>