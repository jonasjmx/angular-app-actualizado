{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/HP/Desktop/angular-app-actualizado/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Component } from \"@angular/core\";\nimport { UserService } from \"../services/user.service\";\nexport let UsersComponent = class UsersComponent {\n  constructor(userSvc) {\n    this.userSvc = userSvc;\n    this.users = [];\n    this.roles = [];\n    this.loadingUsers = true;\n    this.loadingRoles = true;\n    // Alertbox superior para mensajes de éxito/error general\n    this.error = \"\";\n    this.success = \"\";\n    // Variables para el modal de error (para duplicidad, etc.)\n    this.isErrorModalOpen = false;\n    this.modalErrorMessage = \"\";\n    // Regex de Contraseña Segura:\n    // Al menos 1 mayúscula, 1 minúscula, 1 número, 1 carácter especial, min 8 caracteres\n    this.passwordPattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[$@$!%*?&])[A-Za-z\\d$@$!%*?&]{8,}$/;\n    // Regex de Nombres y Apellidos (Solo letras y espacios, incluye tildes y ñ)\n    this.namePattern = \"^[a-zA-ZáéíóúÁÉÍÓÚñÑ\\\\s]+$\";\n    // ----------- CREAR USUARIO (MODAL) -----------\n    this.isCreateModalOpen = false;\n    this.newUser = {\n      email: \"\",\n      password: \"\",\n      firstName: \"\",\n      lastName: \"\"\n    };\n    // ----------- EDITAR USUARIO (MODAL) -----------\n    this.isEditModalOpen = false;\n    this.editUserId = null;\n    this.editUser = {\n      firstName: \"\",\n      lastName: \"\",\n      phoneNumber: \"\",\n      emailConfirmed: false,\n      lockoutEnabled: false,\n      lockoutEnd: null\n    };\n    // Roles dentro del modal de edición\n    this.editUserRoles = [];\n    this.editCurrentRoleId = \"\";\n    this.editNewRoleId = \"\";\n    // ----------- ELIMINAR USUARIO (MODAL) -----------\n    this.isDeleteModalOpen = false;\n    this.userToDelete = null;\n    // ========== IMAGEN DE USUARIO ==========\n    this.currentUserImageSrc = null;\n    this.selectedImageBase64 = null;\n    this.hasUserImage = false;\n    this.loadingImage = false;\n    // ========== VALIDACIONES EXTRA ==========\n    this.phoneEditInvalid = false;\n  }\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      yield _this.loadUsers();\n      yield _this.loadRoles();\n    })();\n  }\n  // ------------ CARGAS INICIALES ------------\n  loadUsers() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.loadingUsers = true;\n      try {\n        _this2.users = yield _this2.userSvc.getUsers();\n        // Cargar foto de cada usuario\n        for (let u of _this2.users) {\n          try {\n            const img = yield _this2.userSvc.getUserImage(u.id);\n            u.profileImage = img;\n          } catch {\n            u.profileImage = null;\n          }\n        }\n        _this2.loadingUsers = false;\n      } catch (err) {\n        console.error(err);\n        _this2.error = \"Error al cargar usuarios\";\n        _this2.loadingUsers = false;\n      }\n    })();\n  }\n  loadRoles() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        _this3.roles = yield _this3.userSvc.getRoles();\n        _this3.loadingRoles = false;\n      } catch (err) {\n        console.error(err);\n        _this3.error = \"Error al cargar roles\";\n        _this3.loadingRoles = false;\n      }\n    })();\n  }\n  // ============== MODAL DE ERROR GENÉRICO ==============\n  openErrorModal(message) {\n    this.modalErrorMessage = message;\n    this.isErrorModalOpen = true;\n  }\n  closeErrorModal() {\n    this.isErrorModalOpen = false;\n    this.modalErrorMessage = \"\";\n  }\n};\nUsersComponent = __decorate([Component({\n  selector: \"app-users\",\n  templateUrl: \"./users.component.html\",\n  styleUrls: [\"./users.component.css\"]\n}), __metadata(\"design:paramtypes\", [UserService])], UsersComponent);\n// ============== VALIDACIÓN Y SANITIZ","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}