{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/User/Desktop/angular-app/angular-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { SalesService } from \"../services/sales.service\";\nimport { ProductService } from \"../services/product.service\";\nimport { CustomerService } from \"../services/customer.service\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/sales.service\";\nimport * as i2 from \"../services/product.service\";\nimport * as i3 from \"../services/customer.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction SalesComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.error);\n  }\n}\nfunction SalesComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r1.success);\n  }\n}\nfunction SalesComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Cargando informaci\\u00F3n, por favor espere...\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SalesComponent_div_6_option_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const c_r9 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", c_r9.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", c_r9.name, \" \");\n  }\n}\nfunction SalesComponent_div_6_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 14)(1, \"div\");\n    i0.ɵɵtext(2, \"Total \\u00EDtems: \");\n    i0.ɵɵelementStart(3, \"strong\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function SalesComponent_div_6_div_9_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r10.clearCart());\n    });\n    i0.ɵɵtext(6, \" Vaciar carrito \");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r5.cartCount);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", !ctx_r5.cartItems.length);\n  }\n}\nfunction SalesComponent_div_6_div_10_option_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"number\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const p_r13 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", p_r13.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", p_r13.name, \" - $\", i0.ɵɵpipeBind2(2, 3, p_r13.unitPrice, \"1.2-2\"), \" \");\n  }\n}\nfunction SalesComponent_div_6_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"h2\");\n    i0.ɵɵtext(2, \"Agregar producto al carrito\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 17)(4, \"div\", 7)(5, \"label\");\n    i0.ɵɵtext(6, \"Producto\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"select\", 18);\n    i0.ɵɵlistener(\"ngModelChange\", function SalesComponent_div_6_div_10_Template_select_ngModelChange_7_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r14.selectedProductId = $event);\n    });\n    i0.ɵɵelementStart(8, \"option\", 19);\n    i0.ɵɵtext(9, \"-- Seleccione producto --\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(10, SalesComponent_div_6_div_10_option_10_Template, 3, 6, \"option\", 20);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"div\", 21)(12, \"label\");\n    i0.ɵɵtext(13, \"Cantidad\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"input\", 22);\n    i0.ɵɵlistener(\"ngModelChange\", function SalesComponent_div_6_div_10_Template_input_ngModelChange_14_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r16 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r16.newQuantity = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"div\", 7)(16, \"button\", 23);\n    i0.ɵɵlistener(\"click\", function SalesComponent_div_6_div_10_Template_button_click_16_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r17 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r17.addToCart());\n    });\n    i0.ɵɵtext(17, \"Agregar\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngModel\", ctx_r6.selectedProductId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngValue\", null);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r6.products);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r6.newQuantity);\n  }\n}\nfunction SalesComponent_div_6_div_11_table_3_tr_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r23 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\")(7, \"input\", 28);\n    i0.ɵɵlistener(\"ngModelChange\", function SalesComponent_div_6_div_11_table_3_tr_14_Template_input_ngModelChange_7_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r23);\n      const item_r21 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(item_r21.quantity = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵpipe(10, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\", 29)(12, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function SalesComponent_div_6_div_11_table_3_tr_14_Template_button_click_12_listener() {\n      i0.ɵɵrestoreView(_r23);\n      const ctx_r24 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r24.updateItem(ctx_r24.p));\n    });\n    i0.ɵɵtext(13, \"\\u270F\\uFE0F\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"button\", 31);\n    i0.ɵɵlistener(\"click\", function SalesComponent_div_6_div_11_table_3_tr_14_Template_button_click_14_listener() {\n      i0.ɵɵrestoreView(_r23);\n      const ctx_r25 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r25.deleteProduct(ctx_r25.p.id));\n    });\n    i0.ɵɵtext(15, \"\\uD83D\\uDDD1\\uFE0F\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const item_r21 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r21.productName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"$\", i0.ɵɵpipeBind2(5, 5, item_r21.unitPrice, \"1.2-2\"), \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵpropertyInterpolate1(\"name\", \"qty_\", item_r21.productId, \"\");\n    i0.ɵɵproperty(\"ngModel\", item_r21.quantity);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"$\", i0.ɵɵpipeBind2(10, 8, item_r21.unitPrice * item_r21.quantity, \"1.2-2\"), \"\");\n  }\n}\nfunction SalesComponent_div_6_div_11_table_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 26)(1, \"thead\")(2, \"tr\")(3, \"th\");\n    i0.ɵɵtext(4, \"Producto\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"Precio unitario\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\");\n    i0.ɵɵtext(8, \"Cantidad\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"Subtotal\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12, \"Acciones\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(13, \"tbody\");\n    i0.ɵɵtemplate(14, SalesComponent_div_6_div_11_table_3_tr_14_Template, 16, 11, \"tr\", 27);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r18 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(14);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r18.cartItems);\n  }\n}\nfunction SalesComponent_div_6_div_11_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 32)(1, \"div\", 33)(2, \"div\")(3, \"strong\");\n    i0.ɵɵtext(4, \"Subtotal:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\")(8, \"strong\");\n    i0.ɵɵtext(9, \"IVA (15%):\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"div\")(13, \"strong\");\n    i0.ɵɵtext(14, \"Total a pagar:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(15);\n    i0.ɵɵpipe(16, \"number\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r19 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" $\", i0.ɵɵpipeBind2(6, 3, ctx_r19.cartSubtotal, \"1.2-2\"), \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" $\", i0.ɵɵpipeBind2(11, 6, ctx_r19.cartIVA, \"1.2-2\"), \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" $\", i0.ɵɵpipeBind2(16, 9, ctx_r19.cartTotalPagar, \"1.2-2\"), \"\");\n  }\n}\nfunction SalesComponent_div_6_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"h2\");\n    i0.ɵɵtext(2, \"Detalles del carrito\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, SalesComponent_div_6_div_11_table_3_Template, 15, 1, \"table\", 24);\n    i0.ɵɵtemplate(4, SalesComponent_div_6_div_11_div_4_Template, 17, 12, \"div\", 25);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r7.cartItems && ctx_r7.cartItems.length);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r7.cartItems.length);\n  }\n}\nfunction SalesComponent_div_6_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r27 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"h2\");\n    i0.ɵɵtext(2, \"Crear orden\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"form\", 34);\n    i0.ɵɵlistener(\"ngSubmit\", function SalesComponent_div_6_div_12_Template_form_ngSubmit_3_listener() {\n      i0.ɵɵrestoreView(_r27);\n      const ctx_r26 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r26.createOrder());\n    });\n    i0.ɵɵelementStart(4, \"div\", 35)(5, \"div\", 7)(6, \"label\");\n    i0.ɵɵtext(7, \"Direcci\\u00F3n de env\\u00EDo\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"input\", 36);\n    i0.ɵɵlistener(\"ngModelChange\", function SalesComponent_div_6_div_12_Template_input_ngModelChange_8_listener($event) {\n      i0.ɵɵrestoreView(_r27);\n      const ctx_r28 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r28.shipAddress = $event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(9, \"div\", 35)(10, \"div\", 7)(11, \"label\");\n    i0.ɵɵtext(12, \"Ciudad\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"input\", 37);\n    i0.ɵɵlistener(\"ngModelChange\", function SalesComponent_div_6_div_12_Template_input_ngModelChange_13_listener($event) {\n      i0.ɵɵrestoreView(_r27);\n      const ctx_r29 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r29.shipCity = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"div\", 7)(15, \"label\");\n    i0.ɵɵtext(16, \"Pa\\u00EDs\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"input\", 38);\n    i0.ɵɵlistener(\"ngModelChange\", function SalesComponent_div_6_div_12_Template_input_ngModelChange_17_listener($event) {\n      i0.ɵɵrestoreView(_r27);\n      const ctx_r30 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r30.shipCountry = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(18, \"div\", 21)(19, \"label\");\n    i0.ɵɵtext(20, \"C\\u00F3digo Postal\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"input\", 39);\n    i0.ɵɵlistener(\"ngModelChange\", function SalesComponent_div_6_div_12_Template_input_ngModelChange_21_listener($event) {\n      i0.ɵɵrestoreView(_r27);\n      const ctx_r31 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r31.shipPostalCode = $event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(22, \"div\", 40)(23, \"button\", 41);\n    i0.ɵɵtext(24, \"Confirmar orden\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"ngModel\", ctx_r8.shipAddress);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r8.shipCity);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r8.shipCountry);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r8.shipPostalCode);\n  }\n}\nfunction SalesComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r33 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 6)(2, \"div\", 7)(3, \"label\");\n    i0.ɵɵtext(4, \"Cliente\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"select\", 8);\n    i0.ɵɵlistener(\"ngModelChange\", function SalesComponent_div_6_Template_select_ngModelChange_5_listener($event) {\n      i0.ɵɵrestoreView(_r33);\n      const ctx_r32 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r32.selectedCustomerId = $event);\n    })(\"change\", function SalesComponent_div_6_Template_select_change_5_listener() {\n      i0.ɵɵrestoreView(_r33);\n      const ctx_r34 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r34.onCustomerChange());\n    });\n    i0.ɵɵelementStart(6, \"option\", 9);\n    i0.ɵɵtext(7, \"-- Seleccione un cliente --\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(8, SalesComponent_div_6_option_8_Template, 2, 2, \"option\", 10);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(9, SalesComponent_div_6_div_9_Template, 7, 2, \"div\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(10, SalesComponent_div_6_div_10_Template, 18, 4, \"div\", 12);\n    i0.ɵɵtemplate(11, SalesComponent_div_6_div_11_Template, 5, 2, \"div\", 12);\n    i0.ɵɵtemplate(12, SalesComponent_div_6_div_12_Template, 25, 4, \"div\", 12);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r3.selectedCustomerId);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.customers);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.selectedCustomerId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.selectedCustomerId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.selectedCustomerId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.selectedCustomerId && ctx_r3.cartItems.length);\n  }\n}\nexport let SalesComponent = /*#__PURE__*/(() => {\n  class SalesComponent {\n    constructor(salesSvc, prodSvc, customerSvc) {\n      this.salesSvc = salesSvc;\n      this.prodSvc = prodSvc;\n      this.customerSvc = customerSvc;\n      this.customers = [];\n      this.products = [];\n      this.selectedCustomerId = \"\";\n      this.cartItems = [];\n      this.cartCount = 0;\n      this.cartTotal = 0;\n      this.cartSubtotal = 0;\n      this.cartIVA = 0;\n      this.cartTotalPagar = 0;\n      // formulario para agregar item\n      this.selectedProductId = null;\n      this.newQuantity = 1;\n      // formulario para crear orden\n      this.shipAddress = \"\";\n      this.shipCity = \"\";\n      this.shipCountry = \"\";\n      this.shipPostalCode = \"\";\n      this.loading = false;\n      this.error = \"\";\n      this.success = \"\";\n    }\n    ngOnInit() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        yield _this.loadCustomersAndProducts();\n      })();\n    }\n    loadCustomersAndProducts() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        _this2.loading = true;\n        _this2.error = \"\";\n        try {\n          const [customers, products] = yield Promise.all([_this2.customerSvc.getCustomers(), _this2.prodSvc.getProducts()]);\n          _this2.customers = customers || [];\n          _this2.products = products || [];\n          _this2.loading = false;\n        } catch (err) {\n          console.error(\"Error cargando clientes/productos:\", err);\n          _this2.error = \"No se pudieron cargar clientes y productos\";\n          _this2.loading = false;\n        }\n      })();\n    }\n    // ====== CARRITO ======\n    onCustomerChange() {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        _this3.success = \"\";\n        _this3.error = \"\";\n        if (!_this3.selectedCustomerId) {\n          _this3.cartItems = [];\n          _this3.cartCount = 0;\n          _this3.cartTotal = 0;\n          return;\n        }\n        yield _this3.loadCart();\n      })();\n    }\n    loadCart() {\n      var _this4 = this;\n      return _asyncToGenerator(function* () {\n        if (!_this4.selectedCustomerId) return;\n        _this4.loading = true;\n        _this4.error = \"\";\n        try {\n          const items = yield _this4.salesSvc.getCartByCustomer(_this4.selectedCustomerId);\n          _this4.cartItems = (items || []).map(x => {\n            const prod = _this4.products.find(p => p.id === x.productId);\n            return {\n              ...x,\n              productName: prod ? prod.name : `Producto #${x.productId}`\n            };\n          });\n          // CALCULOS\n          _this4.cartSubtotal = _this4.cartItems.reduce((acc, it) => acc + it.unitPrice * it.quantity, 0);\n          _this4.cartIVA = _this4.cartSubtotal * 0.15; // IVA DEL 15%\n          _this4.cartTotalPagar = _this4.cartSubtotal + _this4.cartIVA;\n          _this4.cartCount = _this4.cartItems.reduce((acc, it) => acc + it.quantity, 0);\n          _this4.loading = false;\n        } catch (err) {\n          console.error(\"Error al cargar carrito:\", err);\n          _this4.error = \"No se pudo cargar el carrito del cliente\";\n          _this4.loading = false;\n        }\n      })();\n    }\n    addToCart() {\n      var _this5 = this;\n      return _asyncToGenerator(function* () {\n        _this5.success = \"\";\n        _this5.error = \"\";\n        if (!_this5.selectedCustomerId) {\n          _this5.error = \"Seleccione un cliente primero.\";\n          return;\n        }\n        if (!_this5.selectedProductId) {\n          _this5.error = \"Seleccione un producto.\";\n          return;\n        }\n        if (_this5.newQuantity <= 0) {\n          _this5.error = \"La cantidad debe ser mayor a 0.\";\n          return;\n        }\n        const prod = _this5.products.find(p => p.id === _this5.selectedProductId);\n        if (!prod) {\n          _this5.error = \"Producto no encontrado.\";\n          return;\n        }\n        const payload = {\n          productId: prod.id,\n          customerId: _this5.selectedCustomerId,\n          unitPrice: prod.unitPrice || 0,\n          quantity: _this5.newQuantity\n        };\n        try {\n          yield _this5.salesSvc.addCartDetail(payload);\n          _this5.success = \"Producto agregado al carrito.\";\n          _this5.newQuantity = 1;\n          yield _this5.loadCart();\n        } catch (err) {\n          console.error(\"Error al agregar al carrito:\", err);\n          _this5.error = \"No se pudo agregar el producto al carrito\";\n        }\n      })();\n    }\n    updateItem(item) {\n      var _this6 = this;\n      return _asyncToGenerator(function* () {\n        _this6.success = \"\";\n        _this6.error = \"\";\n        if (!_this6.selectedCustomerId) return;\n        if (item.quantity <= 0) {\n          _this6.error = \"La cantidad debe ser mayor a 0.\";\n          return;\n        }\n        const payload = {\n          productId: item.productId,\n          customerId: _this6.selectedCustomerId,\n          unitPrice: item.unitPrice,\n          quantity: item.quantity\n        };\n        try {\n          yield _this6.salesSvc.updateCartDetail(payload);\n          _this6.success = \"Detalle actualizado.\";\n          yield _this6.loadCart();\n        } catch (err) {\n          console.error(\"Error al actualizar detalle:\", err);\n          _this6.error = \"No se pudo actualizar el detalle.\";\n        }\n      })();\n    }\n    deleteItem(item) {\n      var _this7 = this;\n      return _asyncToGenerator(function* () {\n        _this7.success = \"\";\n        _this7.error = \"\";\n        if (!_this7.selectedCustomerId) return;\n        const ok = confirm(`¿Eliminar del carrito el producto \"${item.productName}\"?`);\n        if (!ok) return;\n        try {\n          yield _this7.salesSvc.deleteCartDetail(_this7.selectedCustomerId, item.productId);\n          _this7.success = \"Producto eliminado del carrito.\";\n          yield _this7.loadCart();\n        } catch (err) {\n          console.error(\"Error al eliminar detalle:\", err);\n          _this7.error = \"No se pudo eliminar el producto del carrito.\";\n        }\n      })();\n    }\n    clearCart() {\n      var _this8 = this;\n      return _asyncToGenerator(function* () {\n        _this8.success = \"\";\n        _this8.error = \"\";\n        if (!_this8.selectedCustomerId) return;\n        const ok = confirm(\"¿Vaciar todo el carrito de este cliente?\");\n        if (!ok) return;\n        try {\n          yield _this8.salesSvc.clearCartByCustomer(_this8.selectedCustomerId);\n          _this8.success = \"Carrito vaciado.\";\n          yield _this8.loadCart();\n        } catch (err) {\n          console.error(\"Error al limpiar carrito:\", err);\n          _this8.error = \"No se pudo limpiar el carrito.\";\n        }\n      })();\n    }\n    // ====== CREAR ORDEN ======\n    createOrder() {\n      var _this9 = this;\n      return _asyncToGenerator(function* () {\n        _this9.success = \"\";\n        _this9.error = \"\";\n        if (!_this9.selectedCustomerId) {\n          _this9.error = \"Seleccione un cliente.\";\n          return;\n        }\n        if (!_this9.cartItems.length) {\n          _this9.error = \"El carrito está vacío.\";\n          return;\n        }\n        if (!_this9.shipAddress || !_this9.shipCity || !_this9.shipCountry || !_this9.shipPostalCode) {\n          _this9.error = \"Complete todos los datos de envío.\";\n          return;\n        }\n        const payload = {\n          customerId: _this9.selectedCustomerId,\n          shipAddress: _this9.shipAddress,\n          shipCity: _this9.shipCity,\n          shipCountry: _this9.shipCountry,\n          shipPostalCode: _this9.shipPostalCode,\n          orderDetails: _this9.cartItems.map(it => ({\n            productId: it.productId,\n            unitPrice: it.unitPrice,\n            quantity: it.quantity\n          }))\n        };\n        try {\n          yield _this9.salesSvc.createOrder(payload);\n          _this9.success = \"Orden creada correctamente.\";\n          // opcional: limpiar carrito local\n          yield _this9.loadCart();\n        } catch (err) {\n          console.error(\"Error al crear orden:\", err);\n          _this9.error = \"No se pudo crear la orden.\";\n        }\n      })();\n    }\n    static {\n      this.ɵfac = function SalesComponent_Factory(t) {\n        return new (t || SalesComponent)(i0.ɵɵdirectiveInject(i1.SalesService), i0.ɵɵdirectiveInject(i2.ProductService), i0.ɵɵdirectiveInject(i3.CustomerService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: SalesComponent,\n        selectors: [[\"app-sales\"]],\n        decls: 7,\n        vars: 4,\n        consts: [[1, \"sales-wrapper\"], [\"class\", \"alert alert-error\", 4, \"ngIf\"], [\"class\", \"alert alert-success\", 4, \"ngIf\"], [4, \"ngIf\"], [1, \"alert\", \"alert-error\"], [1, \"alert\", \"alert-success\"], [1, \"filters-row\"], [1, \"field\"], [\"name\", \"customerSelect\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"value\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"summary-box\", 4, \"ngIf\"], [\"class\", \"card\", 4, \"ngIf\"], [3, \"value\"], [1, \"summary-box\"], [1, \"btn-secondary\", 3, \"disabled\", \"click\"], [1, \"card\"], [1, \"add-row\"], [\"name\", \"productSelect\", 3, \"ngModel\", \"ngModelChange\"], [3, \"ngValue\"], [3, \"ngValue\", 4, \"ngFor\", \"ngForOf\"], [1, \"field\", \"small\"], [\"type\", \"number\", \"name\", \"quantity\", \"min\", \"1\", 3, \"ngModel\", \"ngModelChange\"], [1, \"btn-primary\", 3, \"click\"], [\"class\", \"cart-table\", 4, \"ngIf\"], [\"class\", \"totals-container\", 4, \"ngIf\"], [1, \"cart-table\"], [4, \"ngFor\", \"ngForOf\"], [\"type\", \"number\", \"min\", \"1\", 3, \"ngModel\", \"name\", \"ngModelChange\"], [1, \"actions-cell\"], [1, \"icon-btn\", \"edit\", 3, \"click\"], [1, \"icon-btn\", \"delete\", 3, \"click\"], [1, \"totals-container\"], [1, \"totals-box\"], [1, \"order-form\", 3, \"ngSubmit\"], [1, \"row\"], [\"type\", \"text\", \"name\", \"shipAddress\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"name\", \"shipCity\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"name\", \"shipCountry\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"name\", \"shipPostalCode\", 3, \"ngModel\", \"ngModelChange\"], [1, \"buttons-row\"], [\"type\", \"submit\", 1, \"btn-primary\"]],\n        template: function SalesComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"h1\");\n            i0.ɵɵtext(2, \"Gesti\\u00F3n de Ventas\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(3, SalesComponent_div_3_Template, 2, 1, \"div\", 1);\n            i0.ɵɵtemplate(4, SalesComponent_div_4_Template, 2, 1, \"div\", 2);\n            i0.ɵɵtemplate(5, SalesComponent_div_5_Template, 2, 0, \"div\", 3);\n            i0.ɵɵtemplate(6, SalesComponent_div_6_Template, 13, 6, \"div\", 3);\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngIf\", ctx.error);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", ctx.success);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", ctx.loading);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", !ctx.loading);\n          }\n        },\n        dependencies: [i4.NgForOf, i4.NgIf, i5.ɵNgNoValidate, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.DefaultValueAccessor, i5.NumberValueAccessor, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.MinValidator, i5.NgModel, i5.NgForm, i4.DecimalPipe],\n        styles: [\".sales-wrapper[_ngcontent-%COMP%]{width:100%;font-family:Arial,sans-serif}.sales-wrapper[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:12px;color:#164e63}.card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;margin-bottom:8px;color:#0f172a}.alert[_ngcontent-%COMP%]{padding:10px 12px;border-radius:6px;margin-bottom:10px;font-size:14px}.alert-error[_ngcontent-%COMP%]{background:#fee2e2;color:#b91c1c;border:1px solid #fecaca}.alert-success[_ngcontent-%COMP%]{background:#dcfce7;color:#166534;border:1px solid #bbf7d0}.filters-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;gap:16px;margin-bottom:12px}.field[_ngcontent-%COMP%]{display:flex;flex-direction:column}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:4px}.field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:6px 8px;border-radius:4px;border:1px solid #cbd5e1;min-width:180px}.field.small[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .field.small[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:80px}.summary-box[_ngcontent-%COMP%]{background:#f1f5f9;border-radius:8px;padding:8px 12px;display:flex;align-items:center;gap:16px}.card[_ngcontent-%COMP%]{background:#ffffff;border-radius:8px;border:1px solid #e2e8f0;padding:12px 14px;margin-top:12px}.cart-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:8px}.cart-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .cart-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #e5e7eb;padding:8px 10px;text-align:left}.cart-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f9fafb}.btn-primary[_ngcontent-%COMP%]{background-color:#2563eb;color:#fff;border:none;padding:7px 12px;border-radius:6px;cursor:pointer;font-weight:700}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#1d4ed8}.btn-secondary[_ngcontent-%COMP%]{background-color:#64748b;color:#fff;border:none;padding:6px 10px;border-radius:6px;cursor:pointer}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#475569}.action-btn-edit[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;border:none;padding:5px 10px;border-radius:4px;margin-right:4px;cursor:pointer}.action-btn-edit[_ngcontent-%COMP%]:hover{background-color:#2c82c9}.action-btn-delete[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff;border:none;padding:5px 10px;border-radius:4px;cursor:pointer}.action-btn-delete[_ngcontent-%COMP%]:hover{background-color:#c0392b}.add-row[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:flex-end}.order-form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;gap:12px;margin-bottom:8px}.buttons-row[_ngcontent-%COMP%]{margin-top:10px}.totals-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;width:100%;margin-top:15px}.totals-box[_ngcontent-%COMP%]{padding:14px;background:#f8fafc;border:1px solid #e2e8f0;border-radius:10px;min-width:260px;max-width:300px;font-size:15px;line-height:1.7;box-shadow:0 2px 6px #0000000f}.totals-box[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:4px}.totals-box[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:last-child{font-size:17px;font-weight:700}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:8px}.icon-btn[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:6px;cursor:pointer;border:none;font-size:18px;display:flex;align-items:center;justify-content:center;transition:.2s ease}.icon-btn.edit[_ngcontent-%COMP%]{background:#3498db;color:#fff}.icon-btn.delete[_ngcontent-%COMP%]{background:#e74c3c;color:#fff}.icon-btn[_ngcontent-%COMP%]:hover{transform:scale(1.1);filter:brightness(1.15)}.icon-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}\"]\n      });\n    }\n  }\n  return SalesComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}